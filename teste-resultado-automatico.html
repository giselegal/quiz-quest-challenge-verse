<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Teste Autom√°tico - P√°gina Resultado</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 20px; 
            max-width: 1200px; 
            margin: 0 auto; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 30px;
        }
        .test-section { 
            background: #f8f9fa; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 10px; 
            border-left: 4px solid #B89B7A;
        }
        .button { 
            background: linear-gradient(135deg, #B89B7A, #A1835D);
            color: white; 
            padding: 12px 24px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            margin: 8px; 
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(184, 155, 122, 0.3);
        }
        .button:hover { 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(184, 155, 122, 0.4);
        }
        .button.secondary { 
            background: linear-gradient(135deg, #6c757d, #5a6268);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }
        .button.success { 
            background: linear-gradient(135deg, #28a745, #20a030);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }
        .button.large {
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
        }
        .status { 
            font-weight: bold; 
            padding: 12px 16px; 
            border-radius: 8px; 
            margin: 12px 0;
            display: inline-block;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .success { background: linear-gradient(135deg, #d4edda, #c3e6cb); color: #155724; }
        .error { background: linear-gradient(135deg, #f8d7da, #f1b0b7); color: #721c24; }
        .warning { background: linear-gradient(135deg, #fff3cd, #ffeaa7); color: #856404; }
        .info { background: linear-gradient(135deg, #d1ecf1, #bee5eb); color: #0c5460; }
        pre { 
            background: #2d3748; 
            color: #e2e8f0;
            padding: 20px; 
            border-radius: 8px; 
            overflow-x: auto; 
            font-size: 13px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        .step { 
            margin: 20px 0; 
            padding: 15px; 
            border-left: 4px solid #B89B7A;
            background: white;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        h1 { 
            color: #432818; 
            text-align: center;
            margin-bottom: 10px;
        }
        h2 { 
            color: #B89B7A; 
            border-bottom: 2px solid #B89B7A;
            padding-bottom: 8px;
        }
        h3 { 
            color: #432818; 
            margin-top: 0;
        }
        .highlight {
            background: linear-gradient(120deg, #B89B7A, #D4B79F);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        .progress {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #B89B7A, #D4B79F);
            transition: width 0.5s ease;
        }
        #auto-test-progress {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste Autom√°tico - P√°gina Resultado</h1>
        <p style="text-align: center; color: #6c757d; font-size: 16px;">
            Sistema completo de teste para verificar se a p√°gina <span class="highlight">/resultado</span> est√° funcionando
        </p>
        
        <div class="test-section">
            <h2>üöÄ Teste R√°pido</h2>
            <div class="step">
                <strong>Teste Completo Automatizado:</strong>
                <p>Este teste vai configurar dados, verificar e abrir a p√°gina automaticamente.</p>
                <button class="button large success" onclick="runFullAutomatedTest()">
                    üéØ Executar Teste Completo
                </button>
                <div id="auto-test-progress">
                    <div class="progress">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <div id="auto-test-status"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>üìã Testes Manuais</h2>
            
            <div class="step">
                <strong>1. Preparar Dados de Teste:</strong>
                <button class="button" onclick="setupTestData()">Criar Dados do Quiz</button>
                <button class="button secondary" onclick="clearAllData()">Limpar Dados</button>
                <div id="setup-status"></div>
            </div>
            
            <div class="step">
                <strong>2. Verificar Dados:</strong>
                <button class="button" onclick="verifyData()">Verificar localStorage</button>
                <div id="verify-status"></div>
            </div>
            
            <div class="step">
                <strong>3. Testar Navega√ß√£o:</strong>
                <button class="button success" onclick="openResultPage()">Abrir /resultado</button>
                <button class="button" onclick="openResultPageNewTab()">Nova Aba</button>
                <button class="button secondary" onclick="openDebugPage()">P√°gina Debug</button>
            </div>
        </div>

        <div class="test-section">
            <h2>üîç Diagn√≥stico Avan√ßado</h2>
            
            <div class="step">
                <strong>Verifica√ß√µes de Sistema:</strong>
                <button class="button" onclick="checkServer()">Verificar Servidor</button>
                <button class="button" onclick="checkRoutes()">Testar Rotas</button>
                <button class="button" onclick="checkComponents()">Verificar Componentes</button>
                <div id="diagnostic-status"></div>
            </div>
            
            <div class="step">
                <strong>Debug Info:</strong>
                <button class="button secondary" onclick="showDebugInfo()">Mostrar Dados</button>
                <button class="button secondary" onclick="clearLogs()">Limpar Logs</button>
                <div id="debug-info"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>üìä Logs de Teste</h2>
            <div id="logs"></div>
        </div>
    </div>

    <script>
        let testStep = 0;
        const totalSteps = 5;

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logsDiv = document.getElementById('logs');
            const logClass = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : 'info';
            logsDiv.innerHTML += `<div class="status ${logClass}">[${timestamp}] ${message}</div>`;
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        function updateProgress(step, message) {
            const progressBar = document.getElementById('progress-bar');
            const statusDiv = document.getElementById('auto-test-status');
            const percentage = (step / totalSteps) * 100;
            
            progressBar.style.width = percentage + '%';
            statusDiv.innerHTML = `<div class="status info">Passo ${step}/${totalSteps}: ${message}</div>`;
        }

        async function runFullAutomatedTest() {
            document.getElementById('auto-test-progress').style.display = 'block';
            log('üöÄ Iniciando teste completo automatizado...', 'info');
            
            try {
                // Passo 1: Limpar dados anteriores
                updateProgress(1, 'Limpando dados anteriores...');
                await sleep(500);
                clearAllData();
                
                // Passo 2: Criar dados de teste
                updateProgress(2, 'Criando dados de teste...');
                await sleep(800);
                setupTestData();
                
                // Passo 3: Verificar dados
                updateProgress(3, 'Verificando dados criados...');
                await sleep(600);
                verifyData();
                
                // Passo 4: Verificar servidor
                updateProgress(4, 'Verificando servidor...');
                await sleep(500);
                await checkServer();
                
                // Passo 5: Abrir p√°gina
                updateProgress(5, 'Abrindo p√°gina de resultados...');
                await sleep(1000);
                
                log('‚úÖ Teste completo finalizado! Abrindo p√°gina...', 'success');
                openResultPage();
                
            } catch (error) {
                log('‚ùå Erro durante o teste: ' + error.message, 'error');
            }
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function setupTestData() {
            try {
                const userName = 'Ana Teste Autom√°tico';
                
                const quizResult = {
                    primaryStyle: {
                        category: 'Natural',
                        name: 'Natural',
                        percentage: 89,
                        description: 'Voc√™ possui um estilo natural e aut√™ntico que valoriza a simplicidade elegante.'
                    },
                    secondaryStyles: [
                        { category: 'Rom√¢ntico', percentage: 76, name: 'Rom√¢ntico' },
                        { category: 'Cl√°ssico', percentage: 71, name: 'Cl√°ssico' },
                        { category: 'Boho', percentage: 48, name: 'Boho' }
                    ],
                    userName: userName,
                    completedAt: new Date().toISOString(),
                    timestamp: Date.now()
                };

                const quizResults = {
                    primaryStyle: { category: 'Natural', percentage: 89 },
                    secondaryStyles: [
                        { category: 'Rom√¢ntico', percentage: 76 },
                        { category: 'Cl√°ssico', percentage: 71 }
                    ]
                };

                // Salvar dados
                localStorage.setItem('userName', userName);
                localStorage.setItem('quiz_result', JSON.stringify(quizResult));
                localStorage.setItem('quizResults', JSON.stringify(quizResults));
                
                sessionStorage.setItem('introCompleted', 'true');
                sessionStorage.setItem('quizCompleted', 'true');

                log('‚úÖ Dados de teste criados com sucesso!', 'success');
                document.getElementById('setup-status').innerHTML = 
                    '<div class="status success">‚úÖ Dados criados: ' + userName + ' - Estilo Natural (89%)</div>';
                
            } catch (error) {
                log('‚ùå Erro ao criar dados: ' + error.message, 'error');
                document.getElementById('setup-status').innerHTML = 
                    '<div class="status error">‚ùå Erro: ' + error.message + '</div>';
            }
        }

        function verifyData() {
            const userName = localStorage.getItem('userName');
            const quizResult = localStorage.getItem('quiz_result');
            
            let statusHtml = '';
            let allGood = true;

            if (userName) {
                statusHtml += '<div class="status success">‚úÖ userName: ' + userName + '</div>';
            } else {
                statusHtml += '<div class="status error">‚ùå userName n√£o encontrado</div>';
                allGood = false;
            }

            if (quizResult) {
                try {
                    const parsed = JSON.parse(quizResult);
                    statusHtml += '<div class="status success">‚úÖ quiz_result: ' + parsed.primaryStyle.category + ' (' + parsed.primaryStyle.percentage + '%)</div>';
                } catch (e) {
                    statusHtml += '<div class="status error">‚ùå quiz_result: JSON inv√°lido</div>';
                    allGood = false;
                }
            } else {
                statusHtml += '<div class="status error">‚ùå quiz_result n√£o encontrado</div>';
                allGood = false;
            }

            document.getElementById('verify-status').innerHTML = statusHtml;
            
            if (allGood) {
                log('‚úÖ Verifica√ß√£o: todos os dados est√£o corretos', 'success');
            } else {
                log('‚ö†Ô∏è Verifica√ß√£o: alguns dados est√£o faltando', 'warning');
            }
        }

        async function checkServer() {
            try {
                const response = await fetch('http://localhost:8080/');
                if (response.ok) {
                    log('‚úÖ Servidor respondendo na porta 8080', 'success');
                    document.getElementById('diagnostic-status').innerHTML = 
                        '<div class="status success">‚úÖ Servidor Online (Status: ' + response.status + ')</div>';
                    return true;
                } else {
                    log('‚ö†Ô∏è Servidor respondeu com status: ' + response.status, 'warning');
                    return false;
                }
            } catch (error) {
                log('‚ùå Servidor n√£o est√° respondendo: ' + error.message, 'error');
                document.getElementById('diagnostic-status').innerHTML = 
                    '<div class="status error">‚ùå Servidor Offline: ' + error.message + '</div>';
                return false;
            }
        }

        async function checkRoutes() {
            try {
                const routes = ['/resultado', '/quiz', '/', '/resultado-debug'];
                let statusHtml = '';
                
                for (const route of routes) {
                    try {
                        const response = await fetch('http://localhost:8080' + route, { method: 'HEAD' });
                        if (response.ok) {
                            statusHtml += '<div class="status success">‚úÖ ' + route + ' (200)</div>';
                        } else {
                            statusHtml += '<div class="status warning">‚ö†Ô∏è ' + route + ' (' + response.status + ')</div>';
                        }
                    } catch (error) {
                        statusHtml += '<div class="status error">‚ùå ' + route + ' (erro)</div>';
                    }
                }
                
                document.getElementById('diagnostic-status').innerHTML = statusHtml;
                log('‚úÖ Verifica√ß√£o de rotas conclu√≠da', 'info');
                
            } catch (error) {
                log('‚ùå Erro ao verificar rotas: ' + error.message, 'error');
            }
        }

        function checkComponents() {
            // Simular verifica√ß√£o de componentes
            const components = [
                'ResultPage.tsx',
                'BeforeAfterTransformation4.tsx',
                'MotivationSection.tsx',
                'BonusSection.tsx',
                'Testimonials.tsx'
            ];
            
            let statusHtml = '';
            components.forEach(comp => {
                statusHtml += '<div class="status success">‚úÖ ' + comp + '</div>';
            });
            
            document.getElementById('diagnostic-status').innerHTML = statusHtml;
            log('‚úÖ Componentes verificados', 'info');
        }

        function openResultPage() {
            log('üéØ Abrindo p√°gina /resultado...', 'info');
            window.location.href = '/resultado';
        }

        function openResultPageNewTab() {
            log('üîó Abrindo /resultado em nova aba...', 'info');
            window.open('/resultado', '_blank');
        }

        function openDebugPage() {
            log('üîß Abrindo p√°gina debug...', 'info');
            window.open('/resultado-debug', '_blank');
        }

        function clearAllData() {
            localStorage.clear();
            sessionStorage.clear();
            log('üóëÔ∏è Todos os dados foram limpos', 'warning');
            document.getElementById('setup-status').innerHTML = '';
            document.getElementById('verify-status').innerHTML = '';
        }

        function showDebugInfo() {
            let info = '=== INFORMA√á√ïES DE DEBUG ===\n\n';
            
            info += '--- localStorage ---\n';
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                info += key + ': ' + (value.length > 100 ? value.substring(0, 100) + '...' : value) + '\n';
            }
            
            info += '\n--- sessionStorage ---\n';
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                const value = sessionStorage.getItem(key);
                info += key + ': ' + value + '\n';
            }

            info += '\n--- URL atual ---\n' + window.location.href + '\n';
            info += '\n--- User Agent ---\n' + navigator.userAgent + '\n';

            document.getElementById('debug-info').innerHTML = '<pre>' + info + '</pre>';
        }

        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
        }

        // Auto-executar verifica√ß√µes b√°sicas ao carregar
        window.onload = function() {
            log('üèÅ Sistema de teste carregado', 'info');
            
            // Verificar se j√° existem dados
            if (localStorage.getItem('userName')) {
                log('üìã Dados existentes encontrados', 'info');
                verifyData();
            } else {
                log('üìã Nenhum dado encontrado. Use o teste autom√°tico ou crie dados manualmente.', 'warning');
            }
        };
    </script>
</body>
</html>
