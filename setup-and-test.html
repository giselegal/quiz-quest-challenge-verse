<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup e Teste - P√°gina Resultado</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 40px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .container {
            background: rgba(255,255,255,0.95);
            color: #333;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 600px;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .loading { background: #d1ecf1; color: #0c5460; }
        .error { background: #f8d7da; color: #721c24; }
        .countdown {
            font-size: 24px;
            font-weight: bold;
            color: #B89B7A;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Setup Autom√°tico - Teste da P√°gina Resultado</h1>
        <div id="status" class="status loading">
            ‚è≥ Preparando dados de teste...
        </div>
        <div id="countdown"></div>
        <div id="details"></div>
    </div>

    <script>
        console.log("üß™ Iniciando setup autom√°tico...");
        
        function updateStatus(message, type = 'loading') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = 'status ' + type;
            statusDiv.innerHTML = message;
        }
        
        function updateDetails(message) {
            document.getElementById('details').innerHTML = message;
        }

        // Executar setup
        async function runSetup() {
            try {
                updateStatus("üóëÔ∏è Limpando dados anteriores...");
                await sleep(500);
                
                localStorage.clear();
                sessionStorage.clear();
                
                updateStatus("üìù Criando dados de teste...");
                await sleep(800);
                
                const userName = 'Ana Silva Teste';
                const quizResult = {
                    primaryStyle: {
                        category: 'Natural',
                        name: 'Natural',
                        percentage: 89,
                        description: 'Voc√™ possui um estilo natural e aut√™ntico que valoriza a simplicidade elegante.'
                    },
                    secondaryStyles: [
                        { category: 'Rom√¢ntico', percentage: 76, name: 'Rom√¢ntico' },
                        { category: 'Cl√°ssico', percentage: 71, name: 'Cl√°ssico' },
                        { category: 'Boho', percentage: 48, name: 'Boho' }
                    ],
                    userName: userName,
                    completedAt: new Date().toISOString(),
                    timestamp: Date.now()
                };

                const quizResults = {
                    primaryStyle: { category: 'Natural', percentage: 89 },
                    secondaryStyles: [
                        { category: 'Rom√¢ntico', percentage: 76 },
                        { category: 'Cl√°ssico', percentage: 71 }
                    ]
                };

                localStorage.setItem('userName', userName);
                localStorage.setItem('quiz_result', JSON.stringify(quizResult));
                localStorage.setItem('quizResults', JSON.stringify(quizResults));
                sessionStorage.setItem('introCompleted', 'true');
                sessionStorage.setItem('quizCompleted', 'true');
                
                updateStatus("‚úÖ Dados criados com sucesso!", 'success');
                updateDetails(`
                    <p><strong>Nome:</strong> ${userName}</p>
                    <p><strong>Estilo:</strong> ${quizResult.primaryStyle.category}</p>
                    <p><strong>Compatibilidade:</strong> ${quizResult.primaryStyle.percentage}%</p>
                `);
                
                await sleep(1000);
                
                updateStatus("üîç Verificando dados...");
                await sleep(500);
                
                const savedUserName = localStorage.getItem('userName');
                const savedResult = localStorage.getItem('quiz_result');
                
                if (savedUserName && savedResult) {
                    updateStatus("‚úÖ Verifica√ß√£o conclu√≠da! Redirecionando...", 'success');
                    
                    // Countdown para redirecionamento
                    let countdown = 3;
                    const countdownDiv = document.getElementById('countdown');
                    
                    const countdownInterval = setInterval(() => {
                        countdownDiv.innerHTML = `<div class="countdown">Redirecionando em ${countdown}s</div>`;
                        countdown--;
                        
                        if (countdown < 0) {
                            clearInterval(countdownInterval);
                            window.location.href = '/resultado';
                        }
                    }, 1000);
                    
                } else {
                    updateStatus("‚ùå Erro: dados n√£o foram salvos corretamente", 'error');
                }
                
            } catch (error) {
                updateStatus("‚ùå Erro durante o setup: " + error.message, 'error');
                console.error("Erro:", error);
            }
        }
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        // Iniciar setup automaticamente
        window.onload = () => {
            runSetup();
        };
    </script>
</body>
</html>
