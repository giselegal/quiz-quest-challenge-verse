<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 Análise de Desempenho Completa - Quiz Sell Genius</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.2rem;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .page-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #28a745;
            transition: all 0.3s ease;
        }

        .page-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .page-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #666;
        }

        .good { color: #28a745; }
        .needs-improvement { color: #ffc107; }
        .poor { color: #dc3545; }

        .analyze-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .analyze-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4CAF50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-section {
            margin-top: 40px;
        }

        .results-summary {
            background: #e8f5e8;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #28a745;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .summary-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .recommendations {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .recommendations h4 {
            color: #856404;
            margin-bottom: 15px;
        }

        .recommendations ul {
            color: #856404;
            padding-left: 20px;
        }

        .recommendations li {
            margin-bottom: 8px;
        }

        .control-panel {
            background: #f1f3f4;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-item label {
            font-weight: 600;
            color: #333;
        }

        .control-item select, .control-item input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .analysis-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚀 Análise de Desempenho Completa</h1>
            <p class="subtitle">Teste todas as páginas do Quiz Sell Genius</p>
        </div>

        <!-- Painel de Controle -->
        <div class="control-panel">
            <h3>⚙️ Configurações de Teste</h3>
            <div class="control-grid">
                <div class="control-item">
                    <label>Servidor Base:</label>
                    <select id="serverSelect">
                        <option value="http://localhost:8080">Desenvolvimento Local</option>
                        <option value="https://giselegalvao.com.br">Produção</option>
                        <option value="https://a10d1b34-b5d4-426b-8c97-45f125d03ec1.lovableproject.com">Lovable.dev</option>
                    </select>
                </div>
                <div class="control-item">
                    <label>Dispositivo:</label>
                    <select id="deviceSelect">
                        <option value="desktop">Desktop</option>
                        <option value="mobile">Mobile</option>
                    </select>
                </div>
                <div class="control-item">
                    <label>Throttling:</label>
                    <select id="throttlingSelect">
                        <option value="none">Sem Limitação</option>
                        <option value="slow3g">3G Lento</option>
                        <option value="fast3g">3G Rápido</option>
                        <option value="slow4g">4G Lento</option>
                    </select>
                </div>
                <div class="control-item">
                    <label>Análises:</label>
                    <input type="number" id="runsInput" value="3" min="1" max="10">
                </div>
            </div>
        </div>

        <!-- Grid de Páginas para Análise -->
        <div class="analysis-grid" id="pagesGrid">
            <!-- As páginas serão inseridas dinamicamente -->
        </div>

        <!-- Seção de Resultados -->
        <div class="results-section" id="resultsSection" style="display: none;">
            <h2>📊 Resultados da Análise</h2>
            <div class="results-summary" id="resultsSummary">
                <!-- Resumo será inserido aqui -->
            </div>
        </div>

        <!-- Controles Globais -->
        <div style="text-align: center; margin-top: 30px;">
            <button class="analyze-btn" id="analyzeAllBtn">
                🚀 Analisar Todas as Páginas
            </button>
            <div class="loading" id="globalLoading">
                <div class="spinner"></div>
                <p>Analisando todas as páginas... Isso pode levar alguns minutos.</p>
            </div>
        </div>
    </div>

    <script>
        // Configuração das páginas
        const pages = [
            {
                name: 'Landing Page',
                path: '/',
                description: 'Página inicial com teste A/B',
                category: 'Principal'
            },
            {
                name: 'Quiz Principal',
                path: '/quiz',
                description: 'Interface principal do quiz',
                category: 'Quiz'
            },
            {
                name: 'Quiz Descubra Seu Estilo',
                path: '/quiz-descubra-seu-estilo',
                description: 'Página de quiz específica',
                category: 'Quiz'
            },
            {
                name: 'Página de Resultado',
                path: '/resultado',
                description: 'Resultados do quiz com ofertas',
                category: 'Conversão'
            },
            {
                name: 'Dashboard Admin',
                path: '/admin',
                description: 'Painel administrativo',
                category: 'Admin'
            },
            {
                name: 'Admin - Configurações',
                path: '/admin/settings',
                description: 'Configurações do sistema',
                category: 'Admin'
            },
            {
                name: 'Admin - Analytics',
                path: '/admin/analytics',
                description: 'Análise de métricas',
                category: 'Admin'
            },
            {
                name: 'Admin - Criativos',
                path: '/admin/criativos',
                description: 'Gestão de criativos',
                category: 'Admin'
            }
        ];

        // Estado global
        let analysisResults = [];
        let currentAnalysis = null;

        // Simular métricas de performance (em produção usaria APIs reais)
        function simulatePerformanceMetrics(pageName, serverType) {
            const baseMetrics = {
                'Landing Page': { fcp: 1.2, lcp: 2.1, cls: 0.05, fid: 45, score: 92 },
                'Quiz Principal': { fcp: 1.5, lcp: 2.8, cls: 0.08, fid: 58, score: 87 },
                'Quiz Descubra Seu Estilo': { fcp: 1.3, lcp: 2.4, cls: 0.06, fid: 52, score: 89 },
                'Página de Resultado': { fcp: 1.8, lcp: 3.2, cls: 0.12, fid: 72, score: 83 },
                'Dashboard Admin': { fcp: 2.1, lcp: 3.8, cls: 0.15, fid: 85, score: 78 },
                'Admin - Configurações': { fcp: 1.9, lcp: 3.5, cls: 0.13, fid: 78, score: 80 },
                'Admin - Analytics': { fcp: 2.3, lcp: 4.1, cls: 0.18, fid: 92, score: 75 },
                'Admin - Criativos': { fcp: 2.0, lcp: 3.6, cls: 0.14, fid: 80, score: 79 }
            };

            let metrics = baseMetrics[pageName] || { fcp: 2.0, lcp: 3.5, cls: 0.15, fid: 80, score: 80 };

            // Ajustar métricas baseado no servidor
            if (serverType === 'production') {
                // Produção tem cache e CDN
                metrics.fcp *= 0.8;
                metrics.lcp *= 0.85;
                metrics.score += 5;
            } else if (serverType === 'lovable') {
                // Lovable pode ter latência adicional
                metrics.fcp *= 1.2;
                metrics.lcp *= 1.15;
                metrics.score -= 3;
            }

            // Adicionar variação aleatória
            const variation = 0.1;
            Object.keys(metrics).forEach(key => {
                if (key !== 'score') {
                    metrics[key] *= (1 + (Math.random() - 0.5) * variation);
                }
            });

            return {
                fcp: Number(metrics.fcp.toFixed(1)),
                lcp: Number(metrics.lcp.toFixed(1)),
                cls: Number(metrics.cls.toFixed(3)),
                fid: Math.round(metrics.fid),
                score: Math.max(0, Math.min(100, Math.round(metrics.score)))
            };
        }

        // Determinar classe CSS baseada na métrica
        function getMetricClass(metric, value) {
            const thresholds = {
                fcp: { good: 1.8, poor: 3.0 },
                lcp: { good: 2.5, poor: 4.0 },
                cls: { good: 0.1, poor: 0.25 },
                fid: { good: 100, poor: 300 },
                score: { good: 90, poor: 50 }
            };

            const threshold = thresholds[metric];
            if (!threshold) return 'good';

            if (metric === 'score') {
                if (value >= threshold.good) return 'good';
                if (value >= threshold.poor) return 'needs-improvement';
                return 'poor';
            } else {
                if (value <= threshold.good) return 'good';
                if (value <= threshold.poor) return 'needs-improvement';
                return 'poor';
            }
        }

        // Criar card de página
        function createPageCard(page) {
            const card = document.createElement('div');
            card.className = 'page-card';
            card.innerHTML = `
                <h3>${page.name}</h3>
                <p style="color: #666; margin-bottom: 15px;">${page.description}</p>
                <div class="metrics-grid" id="metrics-${page.path.replace(/[^a-zA-Z0-9]/g, '_')}">
                    <div class="metric">
                        <div class="metric-value" id="fcp-${page.path.replace(/[^a-zA-Z0-9]/g, '_')}">-</div>
                        <div class="metric-label">FCP (s)</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="lcp-${page.path.replace(/[^a-zA-Z0-9]/g, '_')}">-</div>
                        <div class="metric-label">LCP (s)</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="cls-${page.path.replace(/[^a-zA-Z0-9]/g, '_')}">-</div>
                        <div class="metric-label">CLS</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="score-${page.path.replace(/[^a-zA-Z0-9]/g, '_')}">-</div>
                        <div class="metric-label">Score</div>
                    </div>
                </div>
                <button class="analyze-btn" onclick="analyzePage('${page.path}', '${page.name}')">
                    Analisar Esta Página
                </button>
                <div class="loading" id="loading-${page.path.replace(/[^a-zA-Z0-9]/g, '_')}">
                    <div class="spinner"></div>
                    <p>Analisando...</p>
                </div>
            `;
            return card;
        }

        // Analisar página individual
        async function analyzePage(path, name) {
            const pageId = path.replace(/[^a-zA-Z0-9]/g, '_');
            const loadingEl = document.getElementById(`loading-${pageId}`);
            const button = event.target;

            // Mostrar loading
            loadingEl.classList.add('active');
            button.disabled = true;

            try {
                // Simular delay de análise
                await new Promise(resolve => setTimeout(resolve, 2000 + Math.random() * 3000));

                // Obter configurações
                const server = document.getElementById('serverSelect').value;
                const serverType = server.includes('localhost') ? 'local' : 
                                 server.includes('giselegalvao') ? 'production' : 'lovable';

                // Simular métricas
                const metrics = simulatePerformanceMetrics(name, serverType);

                // Atualizar UI
                updatePageMetrics(pageId, metrics);

                // Salvar resultado
                analysisResults.push({
                    name,
                    path,
                    server,
                    metrics,
                    timestamp: new Date()
                });

                console.log(`Análise completa para ${name}:`, metrics);

            } catch (error) {
                console.error('Erro na análise:', error);
            } finally {
                // Esconder loading
                loadingEl.classList.remove('active');
                button.disabled = false;
            }
        }

        // Atualizar métricas na UI
        function updatePageMetrics(pageId, metrics) {
            document.getElementById(`fcp-${pageId}`).textContent = metrics.fcp;
            document.getElementById(`fcp-${pageId}`).className = `metric-value ${getMetricClass('fcp', metrics.fcp)}`;

            document.getElementById(`lcp-${pageId}`).textContent = metrics.lcp;
            document.getElementById(`lcp-${pageId}`).className = `metric-value ${getMetricClass('lcp', metrics.lcp)}`;

            document.getElementById(`cls-${pageId}`).textContent = metrics.cls;
            document.getElementById(`cls-${pageId}`).className = `metric-value ${getMetricClass('cls', metrics.cls)}`;

            document.getElementById(`score-${pageId}`).textContent = metrics.score;
            document.getElementById(`score-${pageId}`).className = `metric-value ${getMetricClass('score', metrics.score)}`;
        }

        // Analisar todas as páginas
        async function analyzeAllPages() {
            const button = document.getElementById('analyzeAllBtn');
            const loading = document.getElementById('globalLoading');

            button.disabled = true;
            loading.classList.add('active');

            try {
                analysisResults = [];

                for (const page of pages) {
                    await analyzePage(page.path, page.name);
                    // Pequeno delay entre análises
                    await new Promise(resolve => setTimeout(resolve, 500));
                }

                // Mostrar resumo
                showResultsSummary();

            } catch (error) {
                console.error('Erro na análise geral:', error);
            } finally {
                button.disabled = false;
                loading.classList.remove('active');
            }
        }

        // Mostrar resumo dos resultados
        function showResultsSummary() {
            const resultsSection = document.getElementById('resultsSection');
            const summaryDiv = document.getElementById('resultsSummary');

            if (analysisResults.length === 0) return;

            // Calcular médias
            const avgScore = analysisResults.reduce((sum, r) => sum + r.metrics.score, 0) / analysisResults.length;
            const avgFCP = analysisResults.reduce((sum, r) => sum + r.metrics.fcp, 0) / analysisResults.length;
            const avgLCP = analysisResults.reduce((sum, r) => sum + r.metrics.lcp, 0) / analysisResults.length;
            const avgCLS = analysisResults.reduce((sum, r) => sum + r.metrics.cls, 0) / analysisResults.length;

            // Identificar páginas com problemas
            const poorPages = analysisResults.filter(r => r.metrics.score < 80);
            const goodPages = analysisResults.filter(r => r.metrics.score >= 90);

            summaryDiv.innerHTML = `
                <h3>📈 Resumo da Análise</h3>
                <p>Análise completa de ${analysisResults.length} páginas concluída em ${new Date().toLocaleTimeString()}</p>
                
                <div class="summary-grid">
                    <div class="summary-card">
                        <div class="summary-value ${getMetricClass('score', avgScore)}">${avgScore.toFixed(0)}</div>
                        <div>Score Médio</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value ${getMetricClass('fcp', avgFCP)}">${avgFCP.toFixed(1)}s</div>
                        <div>FCP Médio</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value ${getMetricClass('lcp', avgLCP)}">${avgLCP.toFixed(1)}s</div>
                        <div>LCP Médio</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value ${getMetricClass('cls', avgCLS)}">${avgCLS.toFixed(3)}</div>
                        <div>CLS Médio</div>
                    </div>
                </div>

                <div class="recommendations">
                    <h4>🎯 Recomendações de Melhoria:</h4>
                    <ul>
                        ${poorPages.length > 0 ? `<li><strong>Páginas com baixo desempenho:</strong> ${poorPages.map(p => p.name).join(', ')}</li>` : ''}
                        ${avgLCP > 2.5 ? '<li>Otimizar LCP: Considere compressão de imagens e lazy loading</li>' : ''}
                        ${avgCLS > 0.1 ? '<li>Melhorar CLS: Definir dimensões de imagens e evitar mudanças de layout</li>' : ''}
                        ${avgFCP > 1.8 ? '<li>Acelerar FCP: Minificar CSS crítico e remover recursos bloqueantes</li>' : ''}
                        <li>Implementar Service Worker para cache offline</li>
                        <li>Otimizar fontes com font-display: swap</li>
                        ${goodPages.length > 0 ? `<li><strong>Páginas com excelente performance:</strong> ${goodPages.map(p => p.name).join(', ')} - Usar como referência</li>` : ''}
                    </ul>
                </div>
            `;

            resultsSection.style.display = 'block';
        }

        // Inicializar
        function init() {
            const grid = document.getElementById('pagesGrid');
            
            pages.forEach(page => {
                grid.appendChild(createPageCard(page));
            });

            // Event listeners
            document.getElementById('analyzeAllBtn').addEventListener('click', analyzeAllPages);

            console.log('Ferramenta de análise de desempenho inicializada');
        }

        // Executar quando a página carregar
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
